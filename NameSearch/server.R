library(shiny)library(dplyr)library(ggplot2)# Define server logic required to draw graphsfunction(input, output) {output$distPlot <- renderPlot({    datasetInput<-input$dataset  inputId<-input$inputId    if (datasetInput == "Names (by spelling)") {        # Create graph of names by spelling        data <- all_data    data %>%      filter(Name==inputId) %>%      ggplot(aes(x = factor(Year), y = Number, color = Sex)) +       expand_limits(y=0) +      geom_line(aes(group = Sex)) +       geom_point() +      theme_bw() +      theme(axis.text.x = element_text(angle = 90, hjust = 1)) +      labs(x = "Year",y = "Unique names") +      scale_y_continuous(expand = c(0, 0)) +      ggtitle("Count of unique baby names in Scotland")  }  else {        #Create graph for soundalike names        data <- all_data    data %>%      filter(soundname==phonetic(inputId)) %>%      group_by(Year,Sex,soundname) %>%      summarise(NumberSound = sum(Number)) %>%            ggplot(aes(x = factor(Year), y = NumberSound, color = Sex)) +       expand_limits(y=0) +      geom_line(aes(group=Sex)) +       geom_point() +      theme_bw() +      theme(axis.text.x = element_text(angle = 90, hjust = 1)) +      labs(x = "Year",y = "Unique names") +      scale_y_continuous(expand = c(0, 0)) +      ggtitle("Count of unique baby names in Scotland")  }})}
